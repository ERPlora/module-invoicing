{% load static i18n ui component_tags %}

{% component "list_page"
    title=_("Invoices")
    subtitle=_("Manage your invoices")
    action_label=_("New Invoice")
    action_url=create_url
    action_icon="add-outline"
    module_id="invoicing"
    current_view="invoices" %}

    {% fill "filters" %}
        {% component "filter_bar"
            search_url="/modules/invoicing/invoices/"
            search_target="#invoices-table-container"
            search_placeholder=_("Search invoices...")
            search_name="search"
            search_value=request.GET.search
            search_include="[name='status'],[name='date_from'],[name='date_to']" %}

            {% fill "filters" %}
                <select
                    name="status"
                    class="rounded-lg"
                    style="height: var(--touch-target-min); padding: 0 12px; border: 1px solid var(--border-color); background: var(--bg-color); color: var(--text-color);"
                    hx-get="{% url 'invoicing:invoices' %}"
                    hx-trigger="change"
                    hx-target="#invoices-table-container"
                    hx-include="[name='search'],[name='date_from'],[name='date_to']">
                    <option value="">{% trans "All Status" %}</option>
                    <option value="draft" {% if request.GET.status == 'draft' %}selected{% endif %}>{% trans "Draft" %}</option>
                    <option value="issued" {% if request.GET.status == 'issued' %}selected{% endif %}>{% trans "Issued" %}</option>
                    <option value="paid" {% if request.GET.status == 'paid' %}selected{% endif %}>{% trans "Paid" %}</option>
                    <option value="cancelled" {% if request.GET.status == 'cancelled' %}selected{% endif %}>{% trans "Cancelled" %}</option>
                </select>
                <input
                    type="date"
                    name="date_from"
                    value="{{ request.GET.date_from|default:'' }}"
                    placeholder="{% trans 'From' %}"
                    class="rounded-lg hide-mobile"
                    style="height: var(--touch-target-min); padding: 0 12px; border: 1px solid var(--border-color); background: var(--bg-color); color: var(--text-color);"
                    hx-get="{% url 'invoicing:invoices' %}"
                    hx-trigger="change"
                    hx-target="#invoices-table-container"
                    hx-include="[name='search'],[name='status'],[name='date_to']">
                <input
                    type="date"
                    name="date_to"
                    value="{{ request.GET.date_to|default:'' }}"
                    placeholder="{% trans 'To' %}"
                    class="rounded-lg hide-mobile"
                    style="height: var(--touch-target-min); padding: 0 12px; border: 1px solid var(--border-color); background: var(--bg-color); color: var(--text-color);"
                    hx-get="{% url 'invoicing:invoices' %}"
                    hx-trigger="change"
                    hx-target="#invoices-table-container"
                    hx-include="[name='search'],[name='status'],[name='date_from']">
            {% endfill %}
        {% endcomponent %}
    {% endfill %}

    {% fill "content" %}
        <ion-card class="m-0">
            <ion-card-content class="p-0">
                <div id="invoices-table-container">
                    {% include "invoicing/partials/invoices_table.html" %}
                </div>
            </ion-card-content>
        </ion-card>
    {% endfill %}
{% endcomponent %}
