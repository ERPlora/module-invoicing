{% load djicons i18n djicons djicons %}

<!-- Header -->
<div class="side-sheet-header">
    <h3 class="sheet-title">{% if series %}{% trans "Edit Series" %}{% else %}{% trans "Add Series" %}{% endif %}</h3>
    <button class="sheet-close" @click="closePanel()">
        {% icon "close-outline" %}
    </button>
</div>

<!-- Body -->
<div class="side-sheet-content">
    <form id="series-form"
          hx-post="{% if series %}{% url 'invoicing:series_edit' series.id %}{% else %}{% url 'invoicing:series_add' %}{% endif %}"
          hx-target="#datatable-body"
          hx-swap="innerHTML"
          @htmx:after-request="closePanel()"
          class="flex flex-col gap-4 p-6">
        {% csrf_token %}

        <!-- Prefix -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Prefix" %} *</label>
            {{ form.prefix }}
            {% if form.prefix.errors %}
            <p class="text-sm text-error mt-1">{{ form.prefix.errors.0 }}</p>
            {% endif %}
        </div>

        <!-- Name -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Name" %} *</label>
            {{ form.name }}
            {% if form.name.errors %}
            <p class="text-sm text-error mt-1">{{ form.name.errors.0 }}</p>
            {% endif %}
        </div>

        <!-- Description -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Description" %}</label>
            {{ form.description }}
        </div>

        <!-- Number Digits -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Number Digits" %}</label>
            {{ form.number_digits }}
            <span class="text-xs text-base-content/50 mt-1 block">{% trans "Number of digits for padding (e.g., 6 = F000001)" %}</span>
        </div>

        {% if series %}
        <!-- Next Number Preview -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Next Number Preview" %}</label>
            <span class="font-mono text-lg text-base-content/60">
                {{ series.prefix }}{{ series.next_number|stringformat:"06d" }}
            </span>
        </div>
        {% endif %}

        <!-- Active Toggle -->
        <div class="flex items-center justify-between p-4 rounded-lg bg-base-200/30">
            <div>
                <div class="font-medium text-sm">{% trans "Active" %}</div>
                <div class="text-xs text-base-content/60">{% trans "Allow creating invoices with this series" %}</div>
            </div>
            <label class="toggle color-success">
                <input type="checkbox" name="is_active"
                    {% if form.instance.is_active or not series %}checked{% endif %}>
                <span class="toggle-track"><span class="toggle-thumb"></span></span>
            </label>
        </div>

        <!-- Default Toggle -->
        <div class="flex items-center justify-between p-4 rounded-lg bg-base-200/30">
            <div>
                <div class="font-medium text-sm">{% trans "Default" %}</div>
                <div class="text-xs text-base-content/60">{% trans "Use as default series for new invoices" %}</div>
            </div>
            <label class="toggle color-primary">
                <input type="checkbox" name="is_default"
                    {% if form.instance.is_default %}checked{% endif %}>
                <span class="toggle-track"><span class="toggle-thumb"></span></span>
            </label>
        </div>
    </form>
</div>

<!-- Footer -->
<div class="side-sheet-footer">
    <div class="flex justify-end gap-2">
        <button type="button" class="btn btn-ghost btn-sm" @click="closePanel()">
            {% trans "Cancel" %}
        </button>
        <button type="submit" form="series-form" class="btn btn-sm color-primary">
            {% icon "save-outline" %}
            {% if series %}{% trans "Save" %}{% else %}{% trans "Add Series" %}{% endif %}
        </button>
    </div>
</div>
